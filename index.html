<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Quick Budget List</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #000000;
            --accent: #2563eb;
            --bg: #f3f4f6;
            --card: #ffffff;
        }

        * { box-sizing: border-box; font-family: sans-serif; }

        body {
            background-color: var(--bg);
            margin: 0;
            padding: 10px;
            padding-bottom: 90px;
        }

        h2 { text-align: center; font-size: 1.2rem; margin-bottom: 15px; color: #374151; }

        /* INPUT CARD */
        .input-card {
            background: var(--card);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 15px;
        }

        label { display: block; font-size: 0.75rem; font-weight: bold; color: #6b7280; margin-bottom: 4px; }
        
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 12px;
            background: #f9fafb;
        }
        input:focus { border-color: var(--accent); outline: none; background: #fff; }

        .row { display: flex; gap: 10px; }
        
        button.add-btn {
            width: 100%;
            padding: 14px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
        }

        /* AUTOCOMPLETE LIST */
        #suggestionBox {
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid #e5e7eb;
            background: white;
            position: absolute;
            width: calc(100% - 60px); 
            z-index: 50;
            display: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .suggestion {
            padding: 10px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
        }
        .suggestion:hover { background: #eff6ff; }

        /* RECEIPT STYLE */
        #receiptArea {
            background: #fff;
            padding: 20px;
            border-top: 5px solid var(--accent);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .list-header {
            display: flex; justify-content: space-between;
            border-bottom: 2px dashed #e5e7eb;
            padding-bottom: 10px; margin-bottom: 10px;
            font-weight: bold; color: #374151;
        }

        .list-item {
            display: flex; justify-content: space-between;
            padding: 8px 0; border-bottom: 1px solid #f3f4f6;
        }

        .total-display {
            display: flex; justify-content: space-between;
            margin-top: 15px; padding-top: 10px;
            border-top: 2px dashed #9ca3af;
            font-size: 1.3rem; font-weight: 800;
        }

        /* BOTTOM BAR */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: white; padding: 15px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            display: flex; justify-content: center;
        }
        .dl-btn {
            background: #10b981; color: white;
            border: none; padding: 12px 25px;
            border-radius: 30px; font-weight: bold;
            font-size: 1rem; box-shadow: 0 2px 5px rgba(16, 185, 129, 0.4);
        }
    </style>
</head>
<body>

    <h2>üìù Smart Budget Planner</h2>

    <div class="input-card">
        <div>
            <label>ITEM NAME</label>
            <input type="text" id="itemName" placeholder="Start typing (e.g. Rice, Soap)..." autocomplete="off">
            <div id="suggestionBox"></div>
        </div>

        <div class="row">
            <div style="flex:1">
                <label>QUANTITY</label>
                <input type="number" id="itemQty" placeholder="1" value="1">
            </div>
            <div style="flex:1">
                <label>RATE (Avg)</label>
                <input type="number" id="itemRate" placeholder="0.00">
            </div>
        </div>

        <button class="add-btn" onclick="addItem()">ADD TO LIST</button>
    </div>

    <div id="receiptArea">
        <div style="text-align: center; margin-bottom: 15px;">
            <h3 style="margin:0;">SHOPPING LIST</h3>
            <span id="dateStr" style="font-size:0.8rem; color:#6b7280;"></span>
        </div>

        <div class="list-header">
            <span>Item</span>
            <span>Amt</span>
        </div>
        
        <div id="itemList">
            <div style="text-align:center; padding:20px; color:#9ca3af;">List is empty</div>
        </div>

        <div class="total-display">
            <span>Total:</span>
            <span id="grandTotal">0.00</span>
        </div>
    </div>

    <div class="bottom-nav">
        <button class="dl-btn" onclick="downloadImage()">üì∏ Download HD Receipt</button>
    </div>

    <script>
        // --- BUILT-IN "WEB AVERAGE" DATABASE ---
        // I have added common items with estimated average market rates
        const averagePrices = [
            // Vegetables
            { n: "Potato", p: 30 }, { n: "Onion", p: 45 }, { n: "Tomato", p: 50 },
            { n: "Ginger", p: 120 }, { n: "Garlic", p: 150 }, { n: "Chilly", p: 60 },
            { n: "Coriander", p: 20 }, { n: "Lemon", p: 10 }, { n: "Carrot", p: 40 },
            // Grocery / Pantry
            { n: "Rice (Basmati)", p: 90 }, { n: "Rice (Regular)", p: 50 },
            { n: "Atta (Flour)", p: 40 }, { n: "Dal (Toor)", p: 140 }, { n: "Dal (Moong)", p: 110 },
            { n: "Sugar", p: 42 }, { n: "Salt", p: 20 }, { n: "Cooking Oil (1L)", p: 140 },
            { n: "Tea Powder", p: 250 }, { n: "Coffee", p: 200 },
            // Dairy & Breakfast
            { n: "Milk (1L)", p: 66 }, { n: "Curd", p: 70 }, { n: "Paneer", p: 380 },
            { n: "Butter", p: 54 }, { n: "Bread", p: 45 }, { n: "Eggs (6)", p: 42 },
            // Household / Personal
            { n: "Soap (Bath)", p: 35 }, { n: "Detergent (1kg)", p: 120 }, 
            { n: "Dish Wash Bar", p: 20 }, { n: "Toothpaste", p: 95 },
            { n: "Shampoo", p: 150 }, { n: "Toilet Cleaner", p: 90 }
        ];

        let cart = [];
        document.getElementById('dateStr').innerText = new Date().toLocaleString();

        const nameIn = document.getElementById('itemName');
        const rateIn = document.getElementById('itemRate');
        const box = document.getElementById('suggestionBox');

        // --- SMART AUTOCOMPLETE ---
        nameIn.addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase();
            box.innerHTML = '';
            
            if(val.length < 1) { box.style.display = 'none'; return; }

            const matches = averagePrices.filter(i => i.n.toLowerCase().includes(val));
            
            if(matches.length > 0){
                box.style.display = 'block';
                matches.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'suggestion';
                    div.innerHTML = `<span>${item.n}</span> <b>${item.p}</b>`;
                    div.onclick = () => {
                        nameIn.value = item.n;
                        rateIn.value = item.p; // Auto-fill Average Price
                        box.style.display = 'none';
                    };
                    box.appendChild(div);
                });
            } else {
                box.style.display = 'none';
            }
        });

        // --- CART FUNCTIONS ---
        function addItem(){
            const name = nameIn.value;
            const qty = parseFloat(document.getElementById('itemQty').value) || 1;
            const rate = parseFloat(rateIn.value);

            if(!name || !rate) { alert("Please enter item and rate."); return; }

            cart.push({ name, qty, rate, total: qty * rate });
            render();

            // Reset
            nameIn.value = '';
            rateIn.value = '';
            document.getElementById('itemQty').value = '1';
            box.style.display = 'none';
        }

        function render(){
            const list = document.getElementById('itemList');
            list.innerHTML = '';
            let gTotal = 0;

            if(cart.length === 0) {
                list.innerHTML = '<div style="text-align:center; padding:20px; color:#9ca3af;">List is empty</div>';
                document.getElementById('grandTotal').innerText = '0.00';
                return;
            }

            cart.forEach((item, idx) => {
                gTotal += item.total;
                const div = document.createElement('div');
                div.className = 'list-item';
                div.innerHTML = `
                    <div style="flex-grow:1;">
                        <div>${item.name}</div>
                        <small style="color:#6b7280;">${item.qty} x ${item.rate}</small>
                    </div>
                    <div style="font-weight:bold; min-width:60px; text-align:right;">
                        ${item.total.toFixed(2)}
                        <div style="font-size:0.7rem; color:red; cursor:pointer;" onclick="rem(${idx})">DEL</div>
                    </div>
                `;
                list.appendChild(div);
            });
            document.getElementById('grandTotal').innerText = gTotal.toFixed(2);
        }

        function rem(idx){
            cart.splice(idx, 1);
            render();
        }

        function downloadImage(){
            const el = document.getElementById('receiptArea');
            const btn = document.querySelector('.dl-btn');
            const originalText = btn.innerText;
            
            btn.innerText = "Generating...";
            html2canvas(el, { scale: 3 }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'My_Budget_List.jpg';
                link.href = canvas.toDataURL("image/jpeg", 0.9);
                link.click();
                btn.innerText = originalText;
            });
        }
    </script>
</body>
</html>
